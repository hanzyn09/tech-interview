# 네트워크 Q&A

## OSI 7계층에 대해서 설명하시오

| 계층 | 이름 | 역할 | 주요 프로토콜/장비 |
|------|------|------|-------------------|
| 7 | 응용 계층 | 사용자 인터페이스 제공 | HTTP, FTP, SMTP |
| 6 | 표현 계층 | 데이터 암호화, 압축, 변환 | SSL/TLS, JPEG |
| 5 | 세션 계층 | 세션 관리, 연결 제어 | NetBIOS, RPC |
| 4 | 전송 계층 | 신뢰성 있는 데이터 전송 | TCP, UDP |
| 3 | 네트워크 계층 | 라우팅, 경로 결정 | IP, ICMP, 라우터 |
| 2 | 데이터링크 계층 | 프레임 단위 전송, 오류 검출 | Ethernet, 스위치 |
| 1 | 물리 계층 | 비트 단위 전송 | 케이블, 허브 |

### 라우터와 스위치의 차이
- **라우터**: 3계층(네트워크) 장비, IP 주소 기반 라우팅, 서로 다른 네트워크 연결
- **스위치**: 2계층(데이터링크) 장비, MAC 주소 기반 스위칭, 같은 네트워크 내 연결

## 라우터와 게이트웨이 차이
- **라우터**: 네트워크 간 패킷 라우팅 전담 장비
- **게이트웨이**: 서로 다른 프로토콜이나 네트워크 간 변환/중계 역할, 더 넓은 개념

## 게이트웨이
서로 다른 네트워크나 프로토콜 간의 통신을 가능하게 하는 네트워크 포인트입니다. 프로토콜 변환, 데이터 형식 변환 등을 수행합니다.

## TCP/IP 4계층

| 계층 | 이름 | 역할 | 프로토콜 |
|------|------|------|----------|
| 4 | 응용 계층 | 응용 프로그램 서비스 | HTTP, FTP, DNS |
| 3 | 전송 계층 | 프로세스 간 통신 | TCP, UDP |
| 2 | 인터넷 계층 | IP 주소 기반 라우팅 | IP, ICMP, ARP |
| 1 | 네트워크 접근 계층 | 물리적 네트워크 접근 | Ethernet, WiFi |

### OSI 7계층 쓰지 않고 TCP/IP 쓰는 이유
- **실용성**: TCP/IP는 실제 인터넷에서 사용되는 실무적 모델
- **단순성**: 7계층보다 단순하여 구현과 이해가 쉬움
- **표준화**: 인터넷 표준으로 널리 채택됨
- **효율성**: 불필요한 계층 분리 없이 실제 구현에 적합

## TCP, UDP에 대해서 설명

### TCP (Transmission Control Protocol)
- **연결 지향**: 3-way handshake로 연결 설정
- **신뢰성**: 순서 보장, 오류 검출/복구, 중복 제거
- **흐름 제어**: 수신자 버퍼 크기에 맞춰 전송 속도 조절
- **혼잡 제어**: 네트워크 상황에 따라 전송 속도 조절
- **용도**: 웹, 이메일, 파일 전송 등

### UDP (User Datagram Protocol)
- **비연결 지향**: 연결 설정 없이 즉시 전송
- **비신뢰성**: 순서 보장 안함, 오류 검출만 수행
- **속도**: TCP보다 빠름
- **용도**: 실시간 스트리밍, DNS, DHCP 등

### TCP에서 서버와 클라이언트 함수 호출 순서

**서버**:
1. `socket()` - 소켓 생성
2. `bind()` - IP와 포트 바인딩
3. `listen()` - 연결 대기 상태
4. `accept()` - 클라이언트 연결 수락
5. `recv()/send()` - 데이터 송수신
6. `close()` - 연결 종료

**클라이언트**:
1. `socket()` - 소켓 생성
2. `connect()` - 서버에 연결 요청
3. `send()/recv()` - 데이터 송수신
4. `close()` - 연결 종료

### 3-way handshake에 대해 설명
TCP 연결 설정 과정:
1. **SYN**: 클라이언트가 서버에 연결 요청 (SYN=1, seq=x)
2. **SYN+ACK**: 서버가 연결 수락 응답 (SYN=1, ACK=1, seq=y, ack=x+1)
3. **ACK**: 클라이언트가 확인 응답 (ACK=1, seq=x+1, ack=y+1)

### 4-way handshake에 대해 설명
TCP 연결 종료 과정:
1. **FIN**: 클라이언트가 연결 종료 요청
2. **ACK**: 서버가 종료 요청 확인
3. **FIN**: 서버가 연결 종료 요청
4. **ACK**: 클라이언트가 종료 확인

### 4-way handshake의 비정상 종료상황
- **RST 패킷**: 강제 연결 종료 시 발생
- **타임아웃**: 응답이 없을 때 일정 시간 후 연결 해제
- **Half-open**: 한쪽만 연결이 끊어진 상태
- **TIME_WAIT**: 마지막 ACK 손실 대비 대기 상태

## IP (Internet Protocol)
인터넷에서 패킷을 목적지까지 전달하는 비연결성, 비신뢰성 프로토콜입니다.
- **IPv4**: 32비트 주소 체계
- **IPv6**: 128비트 주소 체계

## ICMP (Internet Control Message Protocol)
IP 통신 중 발생하는 오류나 제어 메시지를 전달하는 프로토콜입니다.
- **ping**: 연결 확인
- **traceroute**: 경로 추적
- **오류 메시지**: Destination Unreachable, Time Exceeded 등

## IGMP (Internet Group Management Protocol)
멀티캐스트 그룹 관리를 위한 프로토콜입니다. 호스트가 멀티캐스트 그룹에 가입하거나 탈퇴할 때 사용됩니다.

## ARP (Address Resolution Protocol)
IP 주소를 MAC 주소로 변환하는 프로토콜입니다.
1. ARP Request: "이 IP 주소의 MAC 주소는?"
2. ARP Reply: "내 MAC 주소는 XX:XX:XX:XX:XX:XX"

## RARP (Reverse Address Resolution Protocol)
MAC 주소를 IP 주소로 변환하는 프로토콜입니다. 디스크가 없는 워크스테이션이 부팅 시 사용합니다.

## DNS란?
Domain Name System의 약자로, 도메인 이름을 IP 주소로 변환하는 시스템입니다.

### 작동순서
1. **로컬 캐시 확인**: 브라우저, OS 캐시 확인
2. **재귀 질의**: 로컬 DNS 서버에 질의
3. **루트 DNS**: 최상위 도메인 DNS 서버 정보 응답
4. **TLD DNS**: 해당 도메인의 권한 있는 DNS 서버 정보 응답
5. **권한 있는 DNS**: 최종 IP 주소 응답
6. **응답 전달**: 각 단계별로 역순으로 응답 전달

### 라운드로빈이란? 및 단점
**라운드로빈**: DNS에서 여러 IP 주소를 순환하며 응답하는 로드 밸런싱 기법

**단점**:
- 서버 상태 고려 안함
- 클라이언트 성능 차이 무시
- 캐싱으로 인한 불균등 분산
- 서버 장애 시 자동 제외 안됨

## Proxy Server
클라이언트와 서버 사이에서 중계 역할을 하는 서버입니다.

**종류**:
- **Forward Proxy**: 클라이언트 대신 요청
- **Reverse Proxy**: 서버 대신 응답

**기능**:
- 캐싱, 보안, 익명성, 접근 제어, 로드 밸런싱

## 로드밸런싱이란?
여러 서버에 부하를 분산시켜 성능과 가용성을 향상시키는 기술입니다.

**알고리즘**:
- **라운드로빈**: 순차적 분배
- **가중 라운드로빈**: 서버 성능에 따른 가중치 적용
- **최소 연결**: 연결 수가 가장 적은 서버 선택
- **IP 해시**: 클라이언트 IP 기반 분배

**계층별 분류**:
- **L4 로드밸런싱**: IP, 포트 기반
- **L7 로드밸런싱**: HTTP 헤더, URL 기반

## 서버 느려질때
**원인 분석**:
1. **CPU 사용률**: `top`, `htop` 명령어로 확인
2. **메모리 사용률**: 메모리 부족, 스왑 발생 확인
3. **디스크 I/O**: `iostat`, `iotop`으로 확인
4. **네트워크**: `netstat`, `ss`로 연결 상태 확인
5. **애플리케이션**: 로그 분석, 프로파일링

**해결 방안**:
- **스케일 업**: 서버 성능 향상
- **스케일 아웃**: 서버 수 증가
- **캐싱**: Redis, Memcached 적용
- **데이터베이스 최적화**: 인덱스, 쿼리 튜닝
- **CDN 활용**: 정적 리소스 분산
- **로드밸런싱**: 부하 분산
- **코드 최적화**: 병목 지점 개선
